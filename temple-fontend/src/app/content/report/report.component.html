<ngx-spinner></ngx-spinner>
<div class="animation-page">
  <div class="ui-g">
    <div class="ui-g-12 ui-lg-12 ui-md-12 ui-sm-12">
      <div style="text-align:center">
        <h1>รายงานผู้สมัครอบรมคอร์สเรียน</h1>
        {{descript}}
      </div>
      <div class="line"></div><br>
      <form [formGroup]="formReport">
        <p-table [columns]="cols" [value]="reportData" [paginator]="true" [rows]="10" [responsive]="true">
          <ng-template pTemplate="caption">
            <div style="text-align:left;">
              <p-autoComplete appClearAutoComplete formControlName="courses" placeholder="กรุณาเลือกชื่อคอร์ส"
                [suggestions]="filteredCourse" value="id" (completeMethod)="filterCourseMultiple($event)"
                [minLength]="1" field="name" [dropdown]="true" (onSelect)="onSelect($event)" (onClear)="onClear($event)"
                [type]="'search'" [disabled]="disabled">
              </p-autoComplete>
            </div>
          </ng-template>
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th rowspan="3" class="bgTable2">ชื่อคอร์ส</th>
              <th colspan="3" class="bgTable1"> เพศ </th>
              <th colspan="2" class="bgTable2"> การเดินทาง </th>
              <th rowspan="3" class="bgTable3"> คนใหม่ </th>
              <th colspan="8" class="bgTable4"> ภูมิภาค </th>
            </tr>
            <tr>
              <th rowspan="2" class="bgTable1_1">หญิง</th>
              <th rowspan="2" class="bgTable1_1">ชาย</th>
              <th rowspan="2" class="bgTable1_1">ไม่ระบุ</th>
              <th rowspan="2" class="bgTable2_2">การเดินทางของวัด</th>
              <th rowspan="2" class="bgTable2_2">การเดินทางด้วยตัวเอง</th>
              <th colspan="2" class="bgTable3_3">ภาคกลาง</th>
              <th colspan="2" class="bgTable3_3">ภาคตะวันออกเฉียงเหนือ</th>
              <th rowspan="2" class="bgTable3_3">ภาคเหนือ</th>
              <th rowspan="2" class="bgTable3_3">ภาคตะวันออก</th>
              <th rowspan="2" class="bgTable3_3">ภาคตะวันตก</th>
              <th rowspan="2" class="bgTable3_3">ภาคใต้</th>
            </tr>
            <tr>
              <th class="bgTable4_4">กรุงเทพฯ</th>
              <th class="bgTable4_4">อื่นๆ</th>
              <th class="bgTable4_4">สกลนคร</th>
              <th class="bgTable4_4">อื่นๆ</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowData>
            <tr>
              <td class="td2">{{rowData['coursesName']}}</td>
              <td class="td1">{{rowData['genderFemale']}}</td>
              <td class="td1">{{rowData['genderMale']}}</td>
              <td class="td1">{{rowData['genderNotspec']}}</td>
              <td class="td2">{{rowData['tranTemple']}}</td>
              <td class="td2">{{rowData['transport']}}</td>
              <td class="td1">{{rowData['newStudent']}}</td>
              <td class="td3">{{rowData['bangkok']}}</td>
              <td class="td3">{{rowData['central']}}</td>
              <td class="td3">{{rowData['sakon']}}</td>
              <td class="td3">{{rowData['northEast']}}</td>
              <td class="td2">{{rowData['north']}}</td>
              <td class="td2">{{rowData['east']}}</td>
              <td class="td2">{{rowData['western']}}</td>
              <td class="td2">{{rowData['south']}}</td>
            </tr>
          </ng-template>
          <ng-template pTemplate="footer" let-rowData>
            <tr>
              <td class="td2">รวม</td>
              <td class="td1">{{count?.genderFemale}}</td>
              <td class="td1">{{count?.genderMale}}</td>
              <td class="td1">{{count?.genderNotspec}}</td>
              <td class="td2">{{count?.tranTemple}}</td>
              <td class="td2">{{count?.transport}}</td>
              <td class="td1">{{count?.newStudent}}</td>
              <td class="td3">{{count?.bangkok}}</td>
              <td class="td3">{{count?.central}}</td>
              <td class="td3">{{count?.sakon}}</td>
              <td class="td3">{{count?.northEast}}</td>
              <td class="td2">{{count?.north}}</td>
              <td class="td2">{{count?.east}}</td>
              <td class="td2">{{count?.western}}</td>
              <td class="td2">{{count?.south}}</td>
            </tr>
          </ng-template>
        </p-table>
      </form>
    </div>
  </div>
</div>